{"ast":null,"code":"/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/**\n * AUTO-GENERATED FILE. DO NOT MODIFY.\n */\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nimport { __extends } from \"tslib\";\nimport * as zrUtil from 'zrender/lib/core/util';\nimport { createSymbol } from '../../util/symbol';\nimport { Group } from '../../util/graphic';\nimport { enterEmphasis, leaveEmphasis, enableHoverEmphasis } from '../../util/states';\nimport { parsePercent } from '../../util/number';\nimport SymbolClz from './Symbol';\nvar EFFECT_RIPPLE_NUMBER = 3;\n\nfunction normalizeSymbolSize(symbolSize) {\n  if (!zrUtil.isArray(symbolSize)) {\n    symbolSize = [+symbolSize, +symbolSize];\n  }\n\n  return symbolSize;\n}\n\nfunction updateRipplePath(rippleGroup, effectCfg) {\n  var color = effectCfg.rippleEffectColor || effectCfg.color;\n  rippleGroup.eachChild(function (ripplePath) {\n    ripplePath.attr({\n      z: effectCfg.z,\n      zlevel: effectCfg.zlevel,\n      style: {\n        stroke: effectCfg.brushType === 'stroke' ? color : null,\n        fill: effectCfg.brushType === 'fill' ? color : null\n      }\n    });\n  });\n}\n\nvar EffectSymbol =\n/** @class */\nfunction (_super) {\n  __extends(EffectSymbol, _super);\n\n  function EffectSymbol(data, idx) {\n    var _this = _super.call(this) || this;\n\n    var symbol = new SymbolClz(data, idx);\n    var rippleGroup = new Group();\n\n    _this.add(symbol);\n\n    _this.add(rippleGroup);\n\n    _this.updateData(data, idx);\n\n    return _this;\n  }\n\n  EffectSymbol.prototype.stopEffectAnimation = function () {\n    this.childAt(1).removeAll();\n  };\n\n  EffectSymbol.prototype.startEffectAnimation = function (effectCfg) {\n    var symbolType = effectCfg.symbolType;\n    var color = effectCfg.color;\n    var rippleGroup = this.childAt(1);\n\n    for (var i = 0; i < EFFECT_RIPPLE_NUMBER; i++) {\n      // If width/height are set too small (e.g., set to 1) on ios10\n      // and macOS Sierra, a circle stroke become a rect, no matter what\n      // the scale is set. So we set width/height as 2. See #4136.\n      var ripplePath = createSymbol(symbolType, -1, -1, 2, 2, color);\n      ripplePath.attr({\n        style: {\n          strokeNoScale: true\n        },\n        z2: 99,\n        silent: true,\n        scaleX: 0.5,\n        scaleY: 0.5\n      });\n      var delay = -i / EFFECT_RIPPLE_NUMBER * effectCfg.period + effectCfg.effectOffset; // TODO Configurable effectCfg.period\n\n      ripplePath.animate('', true).when(effectCfg.period, {\n        scale: [effectCfg.rippleScale / 2, effectCfg.rippleScale / 2]\n      }).delay(delay).start();\n      ripplePath.animateStyle(true).when(effectCfg.period, {\n        opacity: 0\n      }).delay(delay).start();\n      rippleGroup.add(ripplePath);\n    }\n\n    updateRipplePath(rippleGroup, effectCfg);\n  };\n  /**\n   * Update effect symbol\n   */\n\n\n  EffectSymbol.prototype.updateEffectAnimation = function (effectCfg) {\n    var oldEffectCfg = this._effectCfg;\n    var rippleGroup = this.childAt(1); // Must reinitialize effect if following configuration changed\n\n    var DIFFICULT_PROPS = ['symbolType', 'period', 'rippleScale'];\n\n    for (var i = 0; i < DIFFICULT_PROPS.length; i++) {\n      var propName = DIFFICULT_PROPS[i];\n\n      if (oldEffectCfg[propName] !== effectCfg[propName]) {\n        this.stopEffectAnimation();\n        this.startEffectAnimation(effectCfg);\n        return;\n      }\n    }\n\n    updateRipplePath(rippleGroup, effectCfg);\n  };\n  /**\n   * Highlight symbol\n   */\n\n\n  EffectSymbol.prototype.highlight = function () {\n    enterEmphasis(this);\n  };\n  /**\n   * Downplay symbol\n   */\n\n\n  EffectSymbol.prototype.downplay = function () {\n    leaveEmphasis(this);\n  };\n  /**\n   * Update symbol properties\n   */\n\n\n  EffectSymbol.prototype.updateData = function (data, idx) {\n    var _this = this;\n\n    var seriesModel = data.hostModel;\n    this.childAt(0).updateData(data, idx);\n    var rippleGroup = this.childAt(1);\n    var itemModel = data.getItemModel(idx);\n    var symbolType = data.getItemVisual(idx, 'symbol');\n    var symbolSize = normalizeSymbolSize(data.getItemVisual(idx, 'symbolSize'));\n    var symbolStyle = data.getItemVisual(idx, 'style');\n    var color = symbolStyle && symbolStyle.fill;\n    rippleGroup.setScale(symbolSize);\n    rippleGroup.traverse(function (ripplePath) {\n      ripplePath.setStyle('fill', color);\n    });\n    var symbolOffset = itemModel.getShallow('symbolOffset');\n\n    if (symbolOffset) {\n      rippleGroup.x = parsePercent(symbolOffset[0], symbolSize[0]);\n      rippleGroup.y = parsePercent(symbolOffset[1], symbolSize[1]);\n    }\n\n    var symbolRotate = data.getItemVisual(idx, 'symbolRotate');\n    rippleGroup.rotation = (symbolRotate || 0) * Math.PI / 180 || 0;\n    var effectCfg = {};\n    effectCfg.showEffectOn = seriesModel.get('showEffectOn');\n    effectCfg.rippleScale = itemModel.get(['rippleEffect', 'scale']);\n    effectCfg.brushType = itemModel.get(['rippleEffect', 'brushType']);\n    effectCfg.period = itemModel.get(['rippleEffect', 'period']) * 1000;\n    effectCfg.effectOffset = idx / data.count();\n    effectCfg.z = seriesModel.getShallow('z') || 0;\n    effectCfg.zlevel = seriesModel.getShallow('zlevel') || 0;\n    effectCfg.symbolType = symbolType;\n    effectCfg.color = color;\n    effectCfg.rippleEffectColor = itemModel.get(['rippleEffect', 'color']);\n    this.off('mouseover').off('mouseout').off('emphasis').off('normal');\n\n    if (effectCfg.showEffectOn === 'render') {\n      this._effectCfg ? this.updateEffectAnimation(effectCfg) : this.startEffectAnimation(effectCfg);\n      this._effectCfg = effectCfg;\n    } else {\n      // Not keep old effect config\n      this._effectCfg = null;\n      this.stopEffectAnimation();\n\n      this.onHoverStateChange = function (toState) {\n        if (toState === 'emphasis') {\n          if (effectCfg.showEffectOn !== 'render') {\n            _this.startEffectAnimation(effectCfg);\n          }\n        } else if (toState === 'normal') {\n          if (effectCfg.showEffectOn !== 'render') {\n            _this.stopEffectAnimation();\n          }\n        }\n      };\n    }\n\n    this._effectCfg = effectCfg;\n    enableHoverEmphasis(this);\n  };\n\n  ;\n\n  EffectSymbol.prototype.fadeOut = function (cb) {\n    this.off('mouseover').off('mouseout');\n    cb && cb();\n  };\n\n  ;\n  return EffectSymbol;\n}(Group);\n\nzrUtil.inherits(EffectSymbol, Group);\nexport default EffectSymbol;","map":{"version":3,"sources":["/home/kzj/project/finalize/B-S-/源码/react_code/node_modules/echarts/lib/chart/helper/EffectSymbol.js"],"names":["__extends","zrUtil","createSymbol","Group","enterEmphasis","leaveEmphasis","enableHoverEmphasis","parsePercent","SymbolClz","EFFECT_RIPPLE_NUMBER","normalizeSymbolSize","symbolSize","isArray","updateRipplePath","rippleGroup","effectCfg","color","rippleEffectColor","eachChild","ripplePath","attr","z","zlevel","style","stroke","brushType","fill","EffectSymbol","_super","data","idx","_this","call","symbol","add","updateData","prototype","stopEffectAnimation","childAt","removeAll","startEffectAnimation","symbolType","i","strokeNoScale","z2","silent","scaleX","scaleY","delay","period","effectOffset","animate","when","scale","rippleScale","start","animateStyle","opacity","updateEffectAnimation","oldEffectCfg","_effectCfg","DIFFICULT_PROPS","length","propName","highlight","downplay","seriesModel","hostModel","itemModel","getItemModel","getItemVisual","symbolStyle","setScale","traverse","setStyle","symbolOffset","getShallow","x","y","symbolRotate","rotation","Math","PI","showEffectOn","get","count","off","onHoverStateChange","toState","fadeOut","cb","inherits"],"mappings":"AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAASA,SAAT,QAA0B,OAA1B;AACA,OAAO,KAAKC,MAAZ,MAAwB,uBAAxB;AACA,SAASC,YAAT,QAA6B,mBAA7B;AACA,SAASC,KAAT,QAAsB,oBAAtB;AACA,SAASC,aAAT,EAAwBC,aAAxB,EAAuCC,mBAAvC,QAAkE,mBAAlE;AACA,SAASC,YAAT,QAA6B,mBAA7B;AACA,OAAOC,SAAP,MAAsB,UAAtB;AACA,IAAIC,oBAAoB,GAAG,CAA3B;;AAEA,SAASC,mBAAT,CAA6BC,UAA7B,EAAyC;AACvC,MAAI,CAACV,MAAM,CAACW,OAAP,CAAeD,UAAf,CAAL,EAAiC;AAC/BA,IAAAA,UAAU,GAAG,CAAC,CAACA,UAAF,EAAc,CAACA,UAAf,CAAb;AACD;;AAED,SAAOA,UAAP;AACD;;AAED,SAASE,gBAAT,CAA0BC,WAA1B,EAAuCC,SAAvC,EAAkD;AAChD,MAAIC,KAAK,GAAGD,SAAS,CAACE,iBAAV,IAA+BF,SAAS,CAACC,KAArD;AACAF,EAAAA,WAAW,CAACI,SAAZ,CAAsB,UAAUC,UAAV,EAAsB;AAC1CA,IAAAA,UAAU,CAACC,IAAX,CAAgB;AACdC,MAAAA,CAAC,EAAEN,SAAS,CAACM,CADC;AAEdC,MAAAA,MAAM,EAAEP,SAAS,CAACO,MAFJ;AAGdC,MAAAA,KAAK,EAAE;AACLC,QAAAA,MAAM,EAAET,SAAS,CAACU,SAAV,KAAwB,QAAxB,GAAmCT,KAAnC,GAA2C,IAD9C;AAELU,QAAAA,IAAI,EAAEX,SAAS,CAACU,SAAV,KAAwB,MAAxB,GAAiCT,KAAjC,GAAyC;AAF1C;AAHO,KAAhB;AAQD,GATD;AAUD;;AAED,IAAIW,YAAY;AAChB;AACA,UAAUC,MAAV,EAAkB;AAChB5B,EAAAA,SAAS,CAAC2B,YAAD,EAAeC,MAAf,CAAT;;AAEA,WAASD,YAAT,CAAsBE,IAAtB,EAA4BC,GAA5B,EAAiC;AAC/B,QAAIC,KAAK,GAAGH,MAAM,CAACI,IAAP,CAAY,IAAZ,KAAqB,IAAjC;;AAEA,QAAIC,MAAM,GAAG,IAAIzB,SAAJ,CAAcqB,IAAd,EAAoBC,GAApB,CAAb;AACA,QAAIhB,WAAW,GAAG,IAAIX,KAAJ,EAAlB;;AAEA4B,IAAAA,KAAK,CAACG,GAAN,CAAUD,MAAV;;AAEAF,IAAAA,KAAK,CAACG,GAAN,CAAUpB,WAAV;;AAEAiB,IAAAA,KAAK,CAACI,UAAN,CAAiBN,IAAjB,EAAuBC,GAAvB;;AAEA,WAAOC,KAAP;AACD;;AAEDJ,EAAAA,YAAY,CAACS,SAAb,CAAuBC,mBAAvB,GAA6C,YAAY;AACvD,SAAKC,OAAL,CAAa,CAAb,EAAgBC,SAAhB;AACD,GAFD;;AAIAZ,EAAAA,YAAY,CAACS,SAAb,CAAuBI,oBAAvB,GAA8C,UAAUzB,SAAV,EAAqB;AACjE,QAAI0B,UAAU,GAAG1B,SAAS,CAAC0B,UAA3B;AACA,QAAIzB,KAAK,GAAGD,SAAS,CAACC,KAAtB;AACA,QAAIF,WAAW,GAAG,KAAKwB,OAAL,CAAa,CAAb,CAAlB;;AAEA,SAAK,IAAII,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGjC,oBAApB,EAA0CiC,CAAC,EAA3C,EAA+C;AAC7C;AACA;AACA;AACA,UAAIvB,UAAU,GAAGjB,YAAY,CAACuC,UAAD,EAAa,CAAC,CAAd,EAAiB,CAAC,CAAlB,EAAqB,CAArB,EAAwB,CAAxB,EAA2BzB,KAA3B,CAA7B;AACAG,MAAAA,UAAU,CAACC,IAAX,CAAgB;AACdG,QAAAA,KAAK,EAAE;AACLoB,UAAAA,aAAa,EAAE;AADV,SADO;AAIdC,QAAAA,EAAE,EAAE,EAJU;AAKdC,QAAAA,MAAM,EAAE,IALM;AAMdC,QAAAA,MAAM,EAAE,GANM;AAOdC,QAAAA,MAAM,EAAE;AAPM,OAAhB;AASA,UAAIC,KAAK,GAAG,CAACN,CAAD,GAAKjC,oBAAL,GAA4BM,SAAS,CAACkC,MAAtC,GAA+ClC,SAAS,CAACmC,YAArE,CAd6C,CAcsC;;AAEnF/B,MAAAA,UAAU,CAACgC,OAAX,CAAmB,EAAnB,EAAuB,IAAvB,EAA6BC,IAA7B,CAAkCrC,SAAS,CAACkC,MAA5C,EAAoD;AAClDI,QAAAA,KAAK,EAAE,CAACtC,SAAS,CAACuC,WAAV,GAAwB,CAAzB,EAA4BvC,SAAS,CAACuC,WAAV,GAAwB,CAApD;AAD2C,OAApD,EAEGN,KAFH,CAESA,KAFT,EAEgBO,KAFhB;AAGApC,MAAAA,UAAU,CAACqC,YAAX,CAAwB,IAAxB,EAA8BJ,IAA9B,CAAmCrC,SAAS,CAACkC,MAA7C,EAAqD;AACnDQ,QAAAA,OAAO,EAAE;AAD0C,OAArD,EAEGT,KAFH,CAESA,KAFT,EAEgBO,KAFhB;AAGAzC,MAAAA,WAAW,CAACoB,GAAZ,CAAgBf,UAAhB;AACD;;AAEDN,IAAAA,gBAAgB,CAACC,WAAD,EAAcC,SAAd,CAAhB;AACD,GA/BD;AAgCA;AACF;AACA;;;AAGEY,EAAAA,YAAY,CAACS,SAAb,CAAuBsB,qBAAvB,GAA+C,UAAU3C,SAAV,EAAqB;AAClE,QAAI4C,YAAY,GAAG,KAAKC,UAAxB;AACA,QAAI9C,WAAW,GAAG,KAAKwB,OAAL,CAAa,CAAb,CAAlB,CAFkE,CAE/B;;AAEnC,QAAIuB,eAAe,GAAG,CAAC,YAAD,EAAe,QAAf,EAAyB,aAAzB,CAAtB;;AAEA,SAAK,IAAInB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGmB,eAAe,CAACC,MAApC,EAA4CpB,CAAC,EAA7C,EAAiD;AAC/C,UAAIqB,QAAQ,GAAGF,eAAe,CAACnB,CAAD,CAA9B;;AAEA,UAAIiB,YAAY,CAACI,QAAD,CAAZ,KAA2BhD,SAAS,CAACgD,QAAD,CAAxC,EAAoD;AAClD,aAAK1B,mBAAL;AACA,aAAKG,oBAAL,CAA0BzB,SAA1B;AACA;AACD;AACF;;AAEDF,IAAAA,gBAAgB,CAACC,WAAD,EAAcC,SAAd,CAAhB;AACD,GAjBD;AAkBA;AACF;AACA;;;AAGEY,EAAAA,YAAY,CAACS,SAAb,CAAuB4B,SAAvB,GAAmC,YAAY;AAC7C5D,IAAAA,aAAa,CAAC,IAAD,CAAb;AACD,GAFD;AAGA;AACF;AACA;;;AAGEuB,EAAAA,YAAY,CAACS,SAAb,CAAuB6B,QAAvB,GAAkC,YAAY;AAC5C5D,IAAAA,aAAa,CAAC,IAAD,CAAb;AACD,GAFD;AAGA;AACF;AACA;;;AAGEsB,EAAAA,YAAY,CAACS,SAAb,CAAuBD,UAAvB,GAAoC,UAAUN,IAAV,EAAgBC,GAAhB,EAAqB;AACvD,QAAIC,KAAK,GAAG,IAAZ;;AAEA,QAAImC,WAAW,GAAGrC,IAAI,CAACsC,SAAvB;AACA,SAAK7B,OAAL,CAAa,CAAb,EAAgBH,UAAhB,CAA2BN,IAA3B,EAAiCC,GAAjC;AACA,QAAIhB,WAAW,GAAG,KAAKwB,OAAL,CAAa,CAAb,CAAlB;AACA,QAAI8B,SAAS,GAAGvC,IAAI,CAACwC,YAAL,CAAkBvC,GAAlB,CAAhB;AACA,QAAIW,UAAU,GAAGZ,IAAI,CAACyC,aAAL,CAAmBxC,GAAnB,EAAwB,QAAxB,CAAjB;AACA,QAAInB,UAAU,GAAGD,mBAAmB,CAACmB,IAAI,CAACyC,aAAL,CAAmBxC,GAAnB,EAAwB,YAAxB,CAAD,CAApC;AACA,QAAIyC,WAAW,GAAG1C,IAAI,CAACyC,aAAL,CAAmBxC,GAAnB,EAAwB,OAAxB,CAAlB;AACA,QAAId,KAAK,GAAGuD,WAAW,IAAIA,WAAW,CAAC7C,IAAvC;AACAZ,IAAAA,WAAW,CAAC0D,QAAZ,CAAqB7D,UAArB;AACAG,IAAAA,WAAW,CAAC2D,QAAZ,CAAqB,UAAUtD,UAAV,EAAsB;AACzCA,MAAAA,UAAU,CAACuD,QAAX,CAAoB,MAApB,EAA4B1D,KAA5B;AACD,KAFD;AAGA,QAAI2D,YAAY,GAAGP,SAAS,CAACQ,UAAV,CAAqB,cAArB,CAAnB;;AAEA,QAAID,YAAJ,EAAkB;AAChB7D,MAAAA,WAAW,CAAC+D,CAAZ,GAAgBtE,YAAY,CAACoE,YAAY,CAAC,CAAD,CAAb,EAAkBhE,UAAU,CAAC,CAAD,CAA5B,CAA5B;AACAG,MAAAA,WAAW,CAACgE,CAAZ,GAAgBvE,YAAY,CAACoE,YAAY,CAAC,CAAD,CAAb,EAAkBhE,UAAU,CAAC,CAAD,CAA5B,CAA5B;AACD;;AAED,QAAIoE,YAAY,GAAGlD,IAAI,CAACyC,aAAL,CAAmBxC,GAAnB,EAAwB,cAAxB,CAAnB;AACAhB,IAAAA,WAAW,CAACkE,QAAZ,GAAuB,CAACD,YAAY,IAAI,CAAjB,IAAsBE,IAAI,CAACC,EAA3B,GAAgC,GAAhC,IAAuC,CAA9D;AACA,QAAInE,SAAS,GAAG,EAAhB;AACAA,IAAAA,SAAS,CAACoE,YAAV,GAAyBjB,WAAW,CAACkB,GAAZ,CAAgB,cAAhB,CAAzB;AACArE,IAAAA,SAAS,CAACuC,WAAV,GAAwBc,SAAS,CAACgB,GAAV,CAAc,CAAC,cAAD,EAAiB,OAAjB,CAAd,CAAxB;AACArE,IAAAA,SAAS,CAACU,SAAV,GAAsB2C,SAAS,CAACgB,GAAV,CAAc,CAAC,cAAD,EAAiB,WAAjB,CAAd,CAAtB;AACArE,IAAAA,SAAS,CAACkC,MAAV,GAAmBmB,SAAS,CAACgB,GAAV,CAAc,CAAC,cAAD,EAAiB,QAAjB,CAAd,IAA4C,IAA/D;AACArE,IAAAA,SAAS,CAACmC,YAAV,GAAyBpB,GAAG,GAAGD,IAAI,CAACwD,KAAL,EAA/B;AACAtE,IAAAA,SAAS,CAACM,CAAV,GAAc6C,WAAW,CAACU,UAAZ,CAAuB,GAAvB,KAA+B,CAA7C;AACA7D,IAAAA,SAAS,CAACO,MAAV,GAAmB4C,WAAW,CAACU,UAAZ,CAAuB,QAAvB,KAAoC,CAAvD;AACA7D,IAAAA,SAAS,CAAC0B,UAAV,GAAuBA,UAAvB;AACA1B,IAAAA,SAAS,CAACC,KAAV,GAAkBA,KAAlB;AACAD,IAAAA,SAAS,CAACE,iBAAV,GAA8BmD,SAAS,CAACgB,GAAV,CAAc,CAAC,cAAD,EAAiB,OAAjB,CAAd,CAA9B;AACA,SAAKE,GAAL,CAAS,WAAT,EAAsBA,GAAtB,CAA0B,UAA1B,EAAsCA,GAAtC,CAA0C,UAA1C,EAAsDA,GAAtD,CAA0D,QAA1D;;AAEA,QAAIvE,SAAS,CAACoE,YAAV,KAA2B,QAA/B,EAAyC;AACvC,WAAKvB,UAAL,GAAkB,KAAKF,qBAAL,CAA2B3C,SAA3B,CAAlB,GAA0D,KAAKyB,oBAAL,CAA0BzB,SAA1B,CAA1D;AACA,WAAK6C,UAAL,GAAkB7C,SAAlB;AACD,KAHD,MAGO;AACL;AACA,WAAK6C,UAAL,GAAkB,IAAlB;AACA,WAAKvB,mBAAL;;AAEA,WAAKkD,kBAAL,GAA0B,UAAUC,OAAV,EAAmB;AAC3C,YAAIA,OAAO,KAAK,UAAhB,EAA4B;AAC1B,cAAIzE,SAAS,CAACoE,YAAV,KAA2B,QAA/B,EAAyC;AACvCpD,YAAAA,KAAK,CAACS,oBAAN,CAA2BzB,SAA3B;AACD;AACF,SAJD,MAIO,IAAIyE,OAAO,KAAK,QAAhB,EAA0B;AAC/B,cAAIzE,SAAS,CAACoE,YAAV,KAA2B,QAA/B,EAAyC;AACvCpD,YAAAA,KAAK,CAACM,mBAAN;AACD;AACF;AACF,OAVD;AAWD;;AAED,SAAKuB,UAAL,GAAkB7C,SAAlB;AACAT,IAAAA,mBAAmB,CAAC,IAAD,CAAnB;AACD,GA5DD;;AA8DA;;AAEAqB,EAAAA,YAAY,CAACS,SAAb,CAAuBqD,OAAvB,GAAiC,UAAUC,EAAV,EAAc;AAC7C,SAAKJ,GAAL,CAAS,WAAT,EAAsBA,GAAtB,CAA0B,UAA1B;AACAI,IAAAA,EAAE,IAAIA,EAAE,EAAR;AACD,GAHD;;AAKA;AACA,SAAO/D,YAAP;AACD,CAzKD,CAyKExB,KAzKF,CAFA;;AA6KAF,MAAM,CAAC0F,QAAP,CAAgBhE,YAAhB,EAA8BxB,KAA9B;AACA,eAAewB,YAAf","sourcesContent":["\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n\n/**\n * AUTO-GENERATED FILE. DO NOT MODIFY.\n */\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nimport { __extends } from \"tslib\";\nimport * as zrUtil from 'zrender/lib/core/util';\nimport { createSymbol } from '../../util/symbol';\nimport { Group } from '../../util/graphic';\nimport { enterEmphasis, leaveEmphasis, enableHoverEmphasis } from '../../util/states';\nimport { parsePercent } from '../../util/number';\nimport SymbolClz from './Symbol';\nvar EFFECT_RIPPLE_NUMBER = 3;\n\nfunction normalizeSymbolSize(symbolSize) {\n  if (!zrUtil.isArray(symbolSize)) {\n    symbolSize = [+symbolSize, +symbolSize];\n  }\n\n  return symbolSize;\n}\n\nfunction updateRipplePath(rippleGroup, effectCfg) {\n  var color = effectCfg.rippleEffectColor || effectCfg.color;\n  rippleGroup.eachChild(function (ripplePath) {\n    ripplePath.attr({\n      z: effectCfg.z,\n      zlevel: effectCfg.zlevel,\n      style: {\n        stroke: effectCfg.brushType === 'stroke' ? color : null,\n        fill: effectCfg.brushType === 'fill' ? color : null\n      }\n    });\n  });\n}\n\nvar EffectSymbol =\n/** @class */\nfunction (_super) {\n  __extends(EffectSymbol, _super);\n\n  function EffectSymbol(data, idx) {\n    var _this = _super.call(this) || this;\n\n    var symbol = new SymbolClz(data, idx);\n    var rippleGroup = new Group();\n\n    _this.add(symbol);\n\n    _this.add(rippleGroup);\n\n    _this.updateData(data, idx);\n\n    return _this;\n  }\n\n  EffectSymbol.prototype.stopEffectAnimation = function () {\n    this.childAt(1).removeAll();\n  };\n\n  EffectSymbol.prototype.startEffectAnimation = function (effectCfg) {\n    var symbolType = effectCfg.symbolType;\n    var color = effectCfg.color;\n    var rippleGroup = this.childAt(1);\n\n    for (var i = 0; i < EFFECT_RIPPLE_NUMBER; i++) {\n      // If width/height are set too small (e.g., set to 1) on ios10\n      // and macOS Sierra, a circle stroke become a rect, no matter what\n      // the scale is set. So we set width/height as 2. See #4136.\n      var ripplePath = createSymbol(symbolType, -1, -1, 2, 2, color);\n      ripplePath.attr({\n        style: {\n          strokeNoScale: true\n        },\n        z2: 99,\n        silent: true,\n        scaleX: 0.5,\n        scaleY: 0.5\n      });\n      var delay = -i / EFFECT_RIPPLE_NUMBER * effectCfg.period + effectCfg.effectOffset; // TODO Configurable effectCfg.period\n\n      ripplePath.animate('', true).when(effectCfg.period, {\n        scale: [effectCfg.rippleScale / 2, effectCfg.rippleScale / 2]\n      }).delay(delay).start();\n      ripplePath.animateStyle(true).when(effectCfg.period, {\n        opacity: 0\n      }).delay(delay).start();\n      rippleGroup.add(ripplePath);\n    }\n\n    updateRipplePath(rippleGroup, effectCfg);\n  };\n  /**\n   * Update effect symbol\n   */\n\n\n  EffectSymbol.prototype.updateEffectAnimation = function (effectCfg) {\n    var oldEffectCfg = this._effectCfg;\n    var rippleGroup = this.childAt(1); // Must reinitialize effect if following configuration changed\n\n    var DIFFICULT_PROPS = ['symbolType', 'period', 'rippleScale'];\n\n    for (var i = 0; i < DIFFICULT_PROPS.length; i++) {\n      var propName = DIFFICULT_PROPS[i];\n\n      if (oldEffectCfg[propName] !== effectCfg[propName]) {\n        this.stopEffectAnimation();\n        this.startEffectAnimation(effectCfg);\n        return;\n      }\n    }\n\n    updateRipplePath(rippleGroup, effectCfg);\n  };\n  /**\n   * Highlight symbol\n   */\n\n\n  EffectSymbol.prototype.highlight = function () {\n    enterEmphasis(this);\n  };\n  /**\n   * Downplay symbol\n   */\n\n\n  EffectSymbol.prototype.downplay = function () {\n    leaveEmphasis(this);\n  };\n  /**\n   * Update symbol properties\n   */\n\n\n  EffectSymbol.prototype.updateData = function (data, idx) {\n    var _this = this;\n\n    var seriesModel = data.hostModel;\n    this.childAt(0).updateData(data, idx);\n    var rippleGroup = this.childAt(1);\n    var itemModel = data.getItemModel(idx);\n    var symbolType = data.getItemVisual(idx, 'symbol');\n    var symbolSize = normalizeSymbolSize(data.getItemVisual(idx, 'symbolSize'));\n    var symbolStyle = data.getItemVisual(idx, 'style');\n    var color = symbolStyle && symbolStyle.fill;\n    rippleGroup.setScale(symbolSize);\n    rippleGroup.traverse(function (ripplePath) {\n      ripplePath.setStyle('fill', color);\n    });\n    var symbolOffset = itemModel.getShallow('symbolOffset');\n\n    if (symbolOffset) {\n      rippleGroup.x = parsePercent(symbolOffset[0], symbolSize[0]);\n      rippleGroup.y = parsePercent(symbolOffset[1], symbolSize[1]);\n    }\n\n    var symbolRotate = data.getItemVisual(idx, 'symbolRotate');\n    rippleGroup.rotation = (symbolRotate || 0) * Math.PI / 180 || 0;\n    var effectCfg = {};\n    effectCfg.showEffectOn = seriesModel.get('showEffectOn');\n    effectCfg.rippleScale = itemModel.get(['rippleEffect', 'scale']);\n    effectCfg.brushType = itemModel.get(['rippleEffect', 'brushType']);\n    effectCfg.period = itemModel.get(['rippleEffect', 'period']) * 1000;\n    effectCfg.effectOffset = idx / data.count();\n    effectCfg.z = seriesModel.getShallow('z') || 0;\n    effectCfg.zlevel = seriesModel.getShallow('zlevel') || 0;\n    effectCfg.symbolType = symbolType;\n    effectCfg.color = color;\n    effectCfg.rippleEffectColor = itemModel.get(['rippleEffect', 'color']);\n    this.off('mouseover').off('mouseout').off('emphasis').off('normal');\n\n    if (effectCfg.showEffectOn === 'render') {\n      this._effectCfg ? this.updateEffectAnimation(effectCfg) : this.startEffectAnimation(effectCfg);\n      this._effectCfg = effectCfg;\n    } else {\n      // Not keep old effect config\n      this._effectCfg = null;\n      this.stopEffectAnimation();\n\n      this.onHoverStateChange = function (toState) {\n        if (toState === 'emphasis') {\n          if (effectCfg.showEffectOn !== 'render') {\n            _this.startEffectAnimation(effectCfg);\n          }\n        } else if (toState === 'normal') {\n          if (effectCfg.showEffectOn !== 'render') {\n            _this.stopEffectAnimation();\n          }\n        }\n      };\n    }\n\n    this._effectCfg = effectCfg;\n    enableHoverEmphasis(this);\n  };\n\n  ;\n\n  EffectSymbol.prototype.fadeOut = function (cb) {\n    this.off('mouseover').off('mouseout');\n    cb && cb();\n  };\n\n  ;\n  return EffectSymbol;\n}(Group);\n\nzrUtil.inherits(EffectSymbol, Group);\nexport default EffectSymbol;"]},"metadata":{},"sourceType":"module"}