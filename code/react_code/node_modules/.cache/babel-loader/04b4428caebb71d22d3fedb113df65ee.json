{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _withPropsReactive = require('../utils/withPropsReactive');\n\nvar _withPropsReactive2 = _interopRequireDefault(_withPropsReactive);\n\nvar _log = require('../utils/log');\n\nvar _log2 = _interopRequireDefault(_log);\n\nvar _polyeditor = require('../polyeditor');\n\nvar _polyeditor2 = _interopRequireDefault(_polyeditor);\n\nvar _common = require('../utils/common');\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n}\n/*\n * props\n * {\n *  __map__ 父级组件传过来的地图实例\n *\n * }\n */\n\n\nvar configurableProps = ['path', 'draggable', 'extData',\n/* 本插件扩展的属性*/\n'style', 'visible'];\nvar allProps = configurableProps.concat(['zIndex', 'bubble']);\n\nvar Polygon = function (_Component) {\n  _inherits(Polygon, _Component);\n\n  function Polygon(props) {\n    _classCallCheck(this, Polygon);\n\n    var _this = _possibleConstructorReturn(this, (Polygon.__proto__ || Object.getPrototypeOf(Polygon)).call(this, props));\n\n    if (typeof window !== 'undefined') {\n      if (!props.__map__) {\n        _log2.default.warning('MAP_INSTANCE_REQUIRED');\n      } else {\n        var self = _this;\n        _this.setterMap = {\n          visible: function visible(val) {\n            if (val) {\n              self.polygon && self.polygon.show();\n            } else {\n              self.polygon && self.polygon.hide();\n            }\n          },\n          style: function style(val) {\n            self.polygon.setOptions(val);\n          }\n        };\n        _this.converterMap = {\n          path: function path(val) {\n            return self.buildPathValue(val);\n          }\n        };\n        _this.state = {\n          loaded: false\n        };\n        _this.map = props.__map__;\n        _this.element = _this.map.getContainer();\n        setTimeout(function () {\n          _this.initMapPolygon(props);\n        }, 13);\n      }\n    }\n\n    return _this;\n  }\n\n  _createClass(Polygon, [{\n    key: 'initMapPolygon',\n    value: function initMapPolygon(props) {\n      var options = this.buildCreateOptions(props);\n      options.map = this.map;\n      this.polygon = new window.AMap.Polygon(options);\n      this.setState({\n        loaded: true\n      });\n      this.props.onInstanceCreated && this.props.onInstanceCreated();\n    }\n  }, {\n    key: 'buildCreateOptions',\n    value: function buildCreateOptions(props) {\n      var _this2 = this;\n\n      var options = {};\n      allProps.forEach(function (key) {\n        if (key in props) {\n          if (key === 'style' && props.style) {\n            var styleItem = Object.keys(props.style);\n            styleItem.forEach(function (item) {\n              // $FlowFixMe\n              options[item] = props.style[item];\n            }); // visible 做特殊处理\n          } else if (key !== 'visible') {\n            options[key] = _this2.getSetterValue(key, props[key]);\n          }\n        }\n      });\n      return options;\n    }\n  }, {\n    key: 'detectPropChanged',\n    value: function detectPropChanged(key, nextProps) {\n      return this.props[key] !== nextProps[key];\n    }\n  }, {\n    key: 'getSetterValue',\n    value: function getSetterValue(key, value) {\n      if (key in this.converterMap) {\n        return this.converterMap[key](value);\n      }\n\n      return value;\n    }\n  }, {\n    key: 'buildPathValue',\n    value: function buildPathValue(path) {\n      var _this3 = this;\n\n      if (path.length) {\n        var firstNode = path[0];\n\n        if (typeof firstNode[0] === 'number') {\n          return path.map(function (p) {\n            return (0, _common.toLnglat)(p);\n          });\n        }\n\n        if ('getLng' in firstNode) {\n          return path;\n        }\n\n        if ('longitude' in firstNode || 'lng' in firstNode) {\n          return path.map(function (p) {\n            return (0, _common.toLnglat)(p);\n          });\n        }\n\n        if ('length' in firstNode && firstNode.length) {\n          // $FlowFixMe\n          return path.map(function (ring) {\n            return _this3.buildPathValue(ring);\n          });\n        }\n      }\n\n      return [];\n    }\n  }, {\n    key: 'renderEditor',\n    value: function renderEditor(children) {\n      if (!children) {\n        return null;\n      }\n\n      if (_react2.default.Children.count(children) !== 1) {\n        return null;\n      }\n\n      var child = _react2.default.Children.only(children);\n\n      if (child.type === _polyeditor2.default) {\n        return _react2.default.cloneElement(child, {\n          __poly__: this.polygon,\n          __map__: this.map\n        });\n      }\n\n      return null;\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      return this.state.loaded ? this.renderEditor(this.props.children) : null;\n    }\n  }, {\n    key: 'instance',\n    get: function get() {\n      return this.polygon;\n    }\n  }]);\n\n  return Polygon;\n}(_react.Component);\n\nexports.default = (0, _withPropsReactive2.default)(Polygon);","map":{"version":3,"sources":["/home/kzj/project/finalize/final/code/react_code/node_modules/react-amap/lib/polygon/index.js"],"names":["Object","defineProperty","exports","value","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","key","Constructor","protoProps","staticProps","prototype","_react","require","_react2","_interopRequireDefault","_withPropsReactive","_withPropsReactive2","_log","_log2","_polyeditor","_polyeditor2","_common","obj","__esModule","default","_classCallCheck","instance","TypeError","_possibleConstructorReturn","self","call","ReferenceError","_inherits","subClass","superClass","create","constructor","setPrototypeOf","__proto__","configurableProps","allProps","concat","Polygon","_Component","_this","getPrototypeOf","window","__map__","warning","setterMap","visible","val","polygon","show","hide","style","setOptions","converterMap","path","buildPathValue","state","loaded","map","element","getContainer","setTimeout","initMapPolygon","options","buildCreateOptions","AMap","setState","onInstanceCreated","_this2","forEach","styleItem","keys","item","getSetterValue","detectPropChanged","nextProps","_this3","firstNode","p","toLnglat","ring","renderEditor","children","Children","count","child","only","type","cloneElement","__poly__","render","get","Component"],"mappings":"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","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _withPropsReactive = require('../utils/withPropsReactive');\n\nvar _withPropsReactive2 = _interopRequireDefault(_withPropsReactive);\n\nvar _log = require('../utils/log');\n\nvar _log2 = _interopRequireDefault(_log);\n\nvar _polyeditor = require('../polyeditor');\n\nvar _polyeditor2 = _interopRequireDefault(_polyeditor);\n\nvar _common = require('../utils/common');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n/*\n * props\n * {\n *  __map__ 父级组件传过来的地图实例\n *\n * }\n */\n\nvar configurableProps = ['path', 'draggable', 'extData',\n\n/* 本插件扩展的属性*/\n'style', 'visible'];\n\nvar allProps = configurableProps.concat(['zIndex', 'bubble']);\n\nvar Polygon = function (_Component) {\n  _inherits(Polygon, _Component);\n\n  function Polygon(props) {\n    _classCallCheck(this, Polygon);\n\n    var _this = _possibleConstructorReturn(this, (Polygon.__proto__ || Object.getPrototypeOf(Polygon)).call(this, props));\n\n    if (typeof window !== 'undefined') {\n      if (!props.__map__) {\n        _log2.default.warning('MAP_INSTANCE_REQUIRED');\n      } else {\n        var self = _this;\n        _this.setterMap = {\n          visible: function visible(val) {\n            if (val) {\n              self.polygon && self.polygon.show();\n            } else {\n              self.polygon && self.polygon.hide();\n            }\n          },\n          style: function style(val) {\n            self.polygon.setOptions(val);\n          }\n        };\n        _this.converterMap = {\n          path: function path(val) {\n            return self.buildPathValue(val);\n          }\n        };\n        _this.state = {\n          loaded: false\n        };\n        _this.map = props.__map__;\n        _this.element = _this.map.getContainer();\n        setTimeout(function () {\n          _this.initMapPolygon(props);\n        }, 13);\n      }\n    }\n    return _this;\n  }\n\n  _createClass(Polygon, [{\n    key: 'initMapPolygon',\n    value: function initMapPolygon(props) {\n      var options = this.buildCreateOptions(props);\n      options.map = this.map;\n      this.polygon = new window.AMap.Polygon(options);\n      this.setState({\n        loaded: true\n      });\n      this.props.onInstanceCreated && this.props.onInstanceCreated();\n    }\n  }, {\n    key: 'buildCreateOptions',\n    value: function buildCreateOptions(props) {\n      var _this2 = this;\n\n      var options = {};\n      allProps.forEach(function (key) {\n        if (key in props) {\n          if (key === 'style' && props.style) {\n            var styleItem = Object.keys(props.style);\n            styleItem.forEach(function (item) {\n              // $FlowFixMe\n              options[item] = props.style[item];\n            });\n            // visible 做特殊处理\n          } else if (key !== 'visible') {\n            options[key] = _this2.getSetterValue(key, props[key]);\n          }\n        }\n      });\n      return options;\n    }\n  }, {\n    key: 'detectPropChanged',\n    value: function detectPropChanged(key, nextProps) {\n      return this.props[key] !== nextProps[key];\n    }\n  }, {\n    key: 'getSetterValue',\n    value: function getSetterValue(key, value) {\n      if (key in this.converterMap) {\n        return this.converterMap[key](value);\n      }\n      return value;\n    }\n  }, {\n    key: 'buildPathValue',\n    value: function buildPathValue(path) {\n      var _this3 = this;\n\n      if (path.length) {\n        var firstNode = path[0];\n        if (typeof firstNode[0] === 'number') {\n          return path.map(function (p) {\n            return (0, _common.toLnglat)(p);\n          });\n        }\n        if ('getLng' in firstNode) {\n          return path;\n        }\n        if ('longitude' in firstNode || 'lng' in firstNode) {\n          return path.map(function (p) {\n            return (0, _common.toLnglat)(p);\n          });\n        }\n        if ('length' in firstNode && firstNode.length) {\n          // $FlowFixMe\n          return path.map(function (ring) {\n            return _this3.buildPathValue(ring);\n          });\n        }\n      }\n      return [];\n    }\n  }, {\n    key: 'renderEditor',\n    value: function renderEditor(children) {\n      if (!children) {\n        return null;\n      }\n      if (_react2.default.Children.count(children) !== 1) {\n        return null;\n      }\n      var child = _react2.default.Children.only(children);\n      if (child.type === _polyeditor2.default) {\n        return _react2.default.cloneElement(child, {\n          __poly__: this.polygon,\n          __map__: this.map\n        });\n      }\n      return null;\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      return this.state.loaded ? this.renderEditor(this.props.children) : null;\n    }\n  }, {\n    key: 'instance',\n    get: function get() {\n      return this.polygon;\n    }\n  }]);\n\n  return Polygon;\n}(_react.Component);\n\nexports.default = (0, _withPropsReactive2.default)(Polygon);"]},"metadata":{},"sourceType":"script"}