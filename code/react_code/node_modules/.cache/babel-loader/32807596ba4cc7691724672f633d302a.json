{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _reactDom = require('react-dom');\n\nvar _isFun = require('../utils/isFun');\n\nvar _isFun2 = _interopRequireDefault(_isFun);\n\nvar _log = require('../utils/log');\n\nvar _log2 = _interopRequireDefault(_log);\n\nvar _markerUtils = require('../utils/markerUtils');\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n}\n\nif (typeof window !== 'undefined') {\n  var styleText = '.amap_markers_pop_window{\\n    padding: 10px;\\n    border: 1px solid #ddd;\\n    border-radius: 8px;\\n    background: #fff;\\n    position: relative;\\n    display: flex;\\n    flex-wrap: wrap;\\n    justify-content: flex-start;\\n}\\n.amap_markers_pop_window::before{\\n    content: \\' \\';\\n    display: block;\\n    position: absolute;\\n    bottom: -12px;\\n    left: 50%;\\n    margin-left: -7px;\\n    width: 0;\\n    height: 0;\\n    border-top: 12px solid #ddd;\\n    border-left: 7px solid transparent;\\n    border-right: 7px solid transparent;\\n}\\n.amap_markers_pop_window::after{\\n    content: \\' \\';\\n    display: block;\\n    position: absolute;\\n    bottom: -11px;\\n    left: 50%;\\n    margin-left: -6px;\\n    width: 0;\\n    height: 0;\\n    border-top: 11px solid #fff;\\n    border-left: 6px solid transparent;\\n    border-right: 6px solid transparent;\\n}\\n.amap_markers_pop_window_item{\\n    cursor:pointer;\\n    width: 40px;\\n    height: 50px;\\n    display: flex;\\n    align-items: flex-end;\\n    justify-content: center;\\n}\\n.amap_markers_pop_window_item span{\\n    pointer-events: none;\\n}\\n.amap_markers_window_overflow_warning{\\n    text-align: center;\\n    width: 100%;\\n    margin: 5px 0;\\n    color: #666;\\n}';\n  var headEl = document.head || document.getElementsByTagName('head')[0];\n  var styleEl = document.createElement('style');\n  styleEl.type = 'text/css';\n  styleEl.textContent = styleText;\n  headEl.appendChild(styleEl);\n}\n\nvar Component = _react2.default.Component;\nvar SCALE = 0.8;\nvar SIZE_WIDTH = 32 * SCALE;\nvar SIZE_HEIGHT = 46 * SCALE - 2;\nvar SIZE_HOVER_WIDTH = 46 * SCALE;\nvar SIZE_HOVER_HEIGHT = 66 * SCALE - 2;\nvar MAX_INFO_MARKERS = 42;\nvar defaultOpts = {\n  useCluster: false,\n  markersCache: [],\n  markerIDCache: []\n};\nvar ClusterProps = ['gridSize', 'minClusterSize', 'maxZoom', 'averageCenter', 'styles', 'zoomOnClick', 'renderCluserMarker'];\nvar IdKey = '__react_amap__';\n/*\n * props\n * {\n *  useCluster(boolean)是否使用聚合点\n *  markers(array<>)坐标列表\n *  __map__ 父级组件传过来的地图实例\n *  __ele__ 父级组件传过来的地图容器\n * }\n */\n\nvar Markers = function (_Component) {\n  _inherits(Markers, _Component);\n\n  function Markers(props) {\n    _classCallCheck(this, Markers);\n\n    var _this = _possibleConstructorReturn(this, (Markers.__proto__ || Object.getPrototypeOf(Markers)).call(this, props));\n\n    if (typeof window !== 'undefined') {\n      if (!props.__map__) {\n        _log2.default.warning('MAP_INSTANCE_REQUIRED');\n      } else {\n        _this.map = props.__map__;\n        _this.element = _this.map.getContainer();\n        _this.markersCache = defaultOpts.markersCache;\n        _this.useCluster = null;\n        _this.markerIDCache = defaultOpts.markerIDCache;\n        _this.resetOffset = new window.AMap.Pixel(-SIZE_WIDTH / 2, -SIZE_HEIGHT);\n        _this.hoverOffset = new window.AMap.Pixel(-SIZE_HOVER_WIDTH / 2, -SIZE_HOVER_HEIGHT);\n\n        _this.createMarkers(props);\n      }\n    }\n\n    return _this;\n  }\n\n  _createClass(Markers, [{\n    key: 'shouldComponentUpdate',\n    value: function shouldComponentUpdate() {\n      return false;\n    }\n  }, {\n    key: 'createMarkers',\n    value: function createMarkers(props) {\n      var _this2 = this;\n\n      var markers = props.markers || [];\n      var mapMarkers = [];\n      var markerReactChildDOM = {};\n      markers.length && markers.forEach(function (raw, idx) {\n        var options = _this2.buildCreateOptions(props, raw, idx);\n\n        options.map = _this2.map;\n        var markerContent = null;\n\n        if ((0, _isFun2.default)(props.render)) {\n          // $FlowFixMe\n          var markerChild = props.render(raw);\n\n          if (markerChild !== false) {\n            var div = document.createElement('div');\n            div.setAttribute(IdKey, '1');\n            markerContent = div;\n            markerReactChildDOM[idx] = markerChild;\n          }\n        }\n\n        if (!markerContent) {\n          markerContent = document.createElement('div');\n          var img = document.createElement('img');\n          img.src = '//webapi.amap.com/theme/v1.3/markers/n/mark_bs.png';\n          markerContent.appendChild(img);\n        }\n\n        options.content = markerContent;\n        var marker = new window.AMap.Marker(options);\n        marker.on('click', function (e) {\n          _this2.onMarkerClick(e);\n        });\n        marker.on('mouseover', function (e) {\n          _this2.onMarkerHover(e);\n        });\n        marker.on('mouseout', function (e) {\n          _this2.onMarkerHoverOut(e);\n        });\n\n        marker.render = function (marker) {\n          return function (component) {\n            return (0, _markerUtils.renderMarkerComponent)(component, marker);\n          };\n        }(marker);\n\n        _this2.bindMarkerEvents(marker);\n\n        mapMarkers.push(marker);\n      });\n      this.markersCache = mapMarkers;\n      this.markerReactChildDOM = markerReactChildDOM;\n      this.exposeMarkerInstance();\n      this.checkClusterSettings(props);\n    }\n  }, {\n    key: 'checkClusterSettings',\n    value: function checkClusterSettings(props) {\n      var _this3 = this;\n\n      if (props.useCluster) {\n        this.loadClusterPlugin(props.useCluster).then(function (cluster) {\n          cluster.setMarkers(_this3.markersCache);\n        });\n      } else {\n        if (this.mapCluster) {\n          var markers = this.mapCluster.getMarkers();\n          this.mapCluster.clearMarkers();\n          markers.forEach(function (marker) {\n            marker.setMap(_this3.map);\n          });\n        }\n      }\n    }\n  }, {\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      if (this.map) {\n        this.setMarkerChild();\n      }\n    }\n  }, {\n    key: 'setMarkerChild',\n    value: function setMarkerChild() {\n      var _this4 = this;\n\n      Object.keys(this.markerReactChildDOM).forEach(function (idx) {\n        var dom = _this4.markersCache[idx].getContent();\n\n        var child = _this4.markerReactChildDOM[idx];\n\n        _this4.renderMarkerChild(dom, child);\n      });\n    }\n  }, {\n    key: 'renderMarkerChild',\n    value: function renderMarkerChild(dom, child) {\n      (0, _reactDom.render)(_react2.default.createElement('div', null, child), dom);\n    }\n  }, {\n    key: 'buildCreateOptions',\n    value: function buildCreateOptions(props, raw, idx) {\n      var result = {}; // 强制用户通过 render 函数来定义外观\n      // const disabledKeys = ['label', 'icon', 'content'];\n      // 还是不强制好，通过覆盖的方式来(如果有 render，覆盖 content/icon);\n\n      var disabledKeys = ['extData'];\n\n      _markerUtils.MarkerAllProps.forEach(function (key) {\n        if (key in raw && disabledKeys.indexOf(key) === -1) {\n          result[key] = (0, _markerUtils.getPropValue)(key, raw[key]);\n        } else if (key in props) {\n          if ((0, _isFun2.default)(props[key])) {\n            var tmpValue = props[key].call(null, raw, idx);\n            result[key] = (0, _markerUtils.getPropValue)(key, tmpValue);\n          } else {\n            result[key] = (0, _markerUtils.getPropValue)(key, props[key]);\n          }\n        }\n      });\n\n      result.extData = raw;\n      return result;\n    }\n  }, {\n    key: 'componentWillReceiveProps',\n    value: function componentWillReceiveProps(nextProps) {\n      if (this.map) {\n        this.refreshMarkersLayout(nextProps);\n      }\n    }\n  }, {\n    key: 'refreshMarkersLayout',\n    value: function refreshMarkersLayout(nextProps) {\n      var markerChanged = nextProps.markers !== this.props.markers;\n      var clusterChanged = !!this.props.useCluster !== !!nextProps.useCluster;\n\n      if (markerChanged) {\n        this.markersCache.length && this.markersCache.forEach(function (marker) {\n          if (marker) {\n            marker.setMap(null);\n            marker = null;\n          }\n        });\n        this.markersCache = defaultOpts.markersCache;\n        this.createMarkers(nextProps);\n        this.setMarkerChild();\n      }\n\n      if (markerChanged || clusterChanged) {\n        if (this.markersWindow) {\n          this.markersWindow.close();\n        }\n      }\n\n      if (clusterChanged) {\n        this.checkClusterSettings(nextProps);\n      }\n    }\n  }, {\n    key: 'loadClusterPlugin',\n    value: function loadClusterPlugin(clusterConfig) {\n      var _this5 = this;\n\n      if (this.mapCluster) {\n        return Promise.resolve(this.mapCluster);\n      }\n\n      var config = typeof clusterConfig === 'boolean' ? {} : clusterConfig;\n      return new Promise(function (resolve) {\n        _this5.map.plugin(['AMap.MarkerClusterer'], function () {\n          resolve(_this5.createClusterPlugin(config));\n        });\n      });\n    }\n  }, {\n    key: 'createClusterPlugin',\n    value: function createClusterPlugin(config) {\n      var options = {}; // const style = {\n      //   url: clusterIcon,\n      //   size: new window.AMap.Size(56, 56),\n      //   offset: new window.AMap.Pixel(-28, -28)\n      // };\n\n      var defalutOptions = {\n        minClusterSize: 2,\n        zoomOnClick: false,\n        maxZoom: 18,\n        gridSize: 60,\n        // styles: [style, style, style],\n        averageCenter: true\n      };\n      ClusterProps.forEach(function (key) {\n        if (key in config) {\n          options[key] = config[key];\n        } else {\n          options[key] = defalutOptions[key];\n        }\n      });\n      this.mapCluster = new window.AMap.MarkerClusterer(this.map, [], options);\n      var events = {};\n\n      if ('events' in config) {\n        events = config.events;\n\n        if ('created' in events) {\n          events.created(this.mapCluster);\n        }\n      }\n\n      this.initClusterMarkerWindow();\n      this.bindClusterEvent(events);\n      return this.mapCluster;\n    }\n  }, {\n    key: 'onMarkerClick',\n    value: function onMarkerClick(e) {\n      var marker = e.target;\n      this.triggerMarkerClick(e, marker);\n    }\n  }, {\n    key: 'onMarkerHover',\n    value: function onMarkerHover(e) {\n      e.target.setTop(true);\n      this.setMarkerHovered(e, e.target);\n    }\n  }, {\n    key: 'onMarkerHoverOut',\n    value: function onMarkerHoverOut(e) {\n      e.target.setTop(false);\n      this.setMarkerHoverOut(e, e.target);\n    }\n  }, {\n    key: 'onWindowMarkerClick',\n    value: function onWindowMarkerClick(element) {\n      var marker = element.markerRef;\n      this.triggerMarkerClick(null, marker);\n    }\n  }, {\n    key: 'onWindowMarkerHover',\n    value: function onWindowMarkerHover(element) {\n      var marker = element.markerRef;\n      this.setMarkerHovered(null, marker);\n    }\n  }, {\n    key: 'onWindowMarkerHoverOut',\n    value: function onWindowMarkerHoverOut(element) {\n      var marker = element.markerRef;\n      this.setMarkerHoverOut(null, marker);\n    }\n  }, {\n    key: 'setMarkerHovered',\n    value: function setMarkerHovered(e, marker) {\n      this.triggerMarkerHover(e, marker);\n    }\n  }, {\n    key: 'setMarkerHoverOut',\n    value: function setMarkerHoverOut(e, marker) {\n      this.triggerMarkerHoverOut(e, marker);\n    }\n  }, {\n    key: 'triggerMarkerClick',\n    value: function triggerMarkerClick(e, marker) {\n      // const raw = marker.getExtData();\n      var events = this.props.events || {};\n\n      if ((0, _isFun2.default)(events.click)) {\n        events.click(e, marker);\n      }\n    }\n  }, {\n    key: 'triggerMarkerHover',\n    value: function triggerMarkerHover(e, marker) {\n      // const raw = marker.getExtData();\n      var events = this.props.events || {};\n\n      if ((0, _isFun2.default)(events.mouseover)) {\n        events.mouseover(e, marker);\n      }\n    }\n  }, {\n    key: 'triggerMarkerHoverOut',\n    value: function triggerMarkerHoverOut(e, marker) {\n      // const raw = marker.getExtData();\n      var events = this.props.events || {};\n\n      if ((0, _isFun2.default)(events.mouseout)) {\n        events.mouseout(e, marker);\n      }\n    }\n  }, {\n    key: 'initClusterMarkerWindow',\n    value: function initClusterMarkerWindow() {\n      this.markersWindow = new window.AMap.InfoWindow({\n        isCustom: true,\n        autoMove: true,\n        closeWhenClickMap: true,\n        content: '<span>loading...</span>',\n        showShadow: false,\n        offset: new window.AMap.Pixel(0, -20)\n      });\n      this.markersDOM = document.createElement('div');\n      this.markersDOM.className = 'amap_markers_pop_window';\n      this.markersWindow.setContent(this.markersDOM);\n    }\n  }, {\n    key: 'bindClusterEvent',\n    value: function bindClusterEvent(events) {\n      var _this6 = this;\n\n      this.mapCluster.on('click', function (e) {\n        if (_this6.props.useCluster && _this6.props.useCluster.zoomOnClick) {//\n        } else {\n          var returnValue = true;\n\n          if ((0, _isFun2.default)(events.click)) {\n            returnValue = events.click(e);\n          }\n\n          if (returnValue !== false) {\n            _this6.showMarkersInfoWindow(e);\n          }\n        }\n      });\n    }\n  }, {\n    key: 'showMarkersInfoWindow',\n    value: function showMarkersInfoWindow(e) {\n      var _this7 = this;\n\n      var pos = e.lnglat;\n      var markers = e.markers;\n      this.markersDOM.innerHTML = '';\n\n      if (markers && markers.length) {\n        var length = markers.length;\n\n        if (length > MAX_INFO_MARKERS) {\n          markers = markers.slice(0, MAX_INFO_MARKERS);\n        }\n\n        markers.forEach(function (m) {\n          var contentDOM = m.getContent();\n          var itemDOM = document.createElement('div');\n          itemDOM.className = 'window_marker_item';\n          itemDOM.appendChild(contentDOM);\n          itemDOM.markerRef = m;\n          itemDOM.addEventListener('click', _this7.onWindowMarkerClick.bind(_this7, itemDOM), true);\n          itemDOM.addEventListener('mouseover', _this7.onWindowMarkerHover.bind(_this7, itemDOM), true);\n          itemDOM.addEventListener('mouseout', _this7.onWindowMarkerHoverOut.bind(_this7, itemDOM), true);\n\n          _this7.markersDOM.appendChild(itemDOM);\n        });\n\n        if (length > MAX_INFO_MARKERS) {\n          var warning = document.createElement('div');\n          warning.className = 'amap_markers_window_overflow_warning';\n          warning.innerText = '更多坐标请放大地图查看';\n          this.markersDOM.appendChild(warning);\n        }\n      }\n\n      this.markersWindow.open(this.map, pos);\n    }\n  }, {\n    key: 'exposeMarkerInstance',\n    value: function exposeMarkerInstance() {\n      if ('events' in this.props) {\n        var events = this.props.events || {};\n\n        if ((0, _isFun2.default)(events.created)) {\n          events.created(this.markersCache);\n        }\n      }\n    }\n  }, {\n    key: 'bindMarkerEvents',\n    value: function bindMarkerEvents(marker) {\n      var events = this.props.events || {};\n      var list = Object.keys(events);\n      var preserveEv = ['click', 'mouseover', 'mouseout', 'created'];\n      list.length && list.forEach(function (evName) {\n        if (preserveEv.indexOf(evName) === -1) {\n          marker.on(evName, events[evName]);\n        }\n      });\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      return null;\n    }\n  }]);\n\n  return Markers;\n}(Component);\n\nexports.default = Markers;","map":{"version":3,"sources":["/home/kzj/project/finalize/final/code/react_code/node_modules/react-amap/lib/markers/index.js"],"names":["Object","defineProperty","exports","value","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","key","Constructor","protoProps","staticProps","prototype","_react","require","_react2","_interopRequireDefault","_reactDom","_isFun","_isFun2","_log","_log2","_markerUtils","obj","__esModule","default","_classCallCheck","instance","TypeError","_possibleConstructorReturn","self","call","ReferenceError","_inherits","subClass","superClass","create","constructor","setPrototypeOf","__proto__","window","styleText","headEl","document","head","getElementsByTagName","styleEl","createElement","type","textContent","appendChild","Component","SCALE","SIZE_WIDTH","SIZE_HEIGHT","SIZE_HOVER_WIDTH","SIZE_HOVER_HEIGHT","MAX_INFO_MARKERS","defaultOpts","useCluster","markersCache","markerIDCache","ClusterProps","IdKey","Markers","_Component","_this","getPrototypeOf","__map__","warning","map","element","getContainer","resetOffset","AMap","Pixel","hoverOffset","createMarkers","shouldComponentUpdate","_this2","markers","mapMarkers","markerReactChildDOM","forEach","raw","idx","options","buildCreateOptions","markerContent","render","markerChild","div","setAttribute","img","src","content","marker","Marker","on","e","onMarkerClick","onMarkerHover","onMarkerHoverOut","component","renderMarkerComponent","bindMarkerEvents","push","exposeMarkerInstance","checkClusterSettings","_this3","loadClusterPlugin","then","cluster","setMarkers","mapCluster","getMarkers","clearMarkers","setMap","componentDidMount","setMarkerChild","_this4","keys","dom","getContent","child","renderMarkerChild","result","disabledKeys","MarkerAllProps","indexOf","getPropValue","tmpValue","extData","componentWillReceiveProps","nextProps","refreshMarkersLayout","markerChanged","clusterChanged","markersWindow","close","clusterConfig","_this5","Promise","resolve","config","plugin","createClusterPlugin","defalutOptions","minClusterSize","zoomOnClick","maxZoom","gridSize","averageCenter","MarkerClusterer","events","created","initClusterMarkerWindow","bindClusterEvent","triggerMarkerClick","setTop","setMarkerHovered","setMarkerHoverOut","onWindowMarkerClick","markerRef","onWindowMarkerHover","onWindowMarkerHoverOut","triggerMarkerHover","triggerMarkerHoverOut","click","mouseover","mouseout","InfoWindow","isCustom","autoMove","closeWhenClickMap","showShadow","offset","markersDOM","className","setContent","_this6","returnValue","showMarkersInfoWindow","_this7","pos","lnglat","innerHTML","slice","m","contentDOM","itemDOM","addEventListener","bind","innerText","open","list","preserveEv","evName"],"mappings":"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","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _reactDom = require('react-dom');\n\nvar _isFun = require('../utils/isFun');\n\nvar _isFun2 = _interopRequireDefault(_isFun);\n\nvar _log = require('../utils/log');\n\nvar _log2 = _interopRequireDefault(_log);\n\nvar _markerUtils = require('../utils/markerUtils');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nif (typeof window !== 'undefined') {\n  var styleText = '.amap_markers_pop_window{\\n    padding: 10px;\\n    border: 1px solid #ddd;\\n    border-radius: 8px;\\n    background: #fff;\\n    position: relative;\\n    display: flex;\\n    flex-wrap: wrap;\\n    justify-content: flex-start;\\n}\\n.amap_markers_pop_window::before{\\n    content: \\' \\';\\n    display: block;\\n    position: absolute;\\n    bottom: -12px;\\n    left: 50%;\\n    margin-left: -7px;\\n    width: 0;\\n    height: 0;\\n    border-top: 12px solid #ddd;\\n    border-left: 7px solid transparent;\\n    border-right: 7px solid transparent;\\n}\\n.amap_markers_pop_window::after{\\n    content: \\' \\';\\n    display: block;\\n    position: absolute;\\n    bottom: -11px;\\n    left: 50%;\\n    margin-left: -6px;\\n    width: 0;\\n    height: 0;\\n    border-top: 11px solid #fff;\\n    border-left: 6px solid transparent;\\n    border-right: 6px solid transparent;\\n}\\n.amap_markers_pop_window_item{\\n    cursor:pointer;\\n    width: 40px;\\n    height: 50px;\\n    display: flex;\\n    align-items: flex-end;\\n    justify-content: center;\\n}\\n.amap_markers_pop_window_item span{\\n    pointer-events: none;\\n}\\n.amap_markers_window_overflow_warning{\\n    text-align: center;\\n    width: 100%;\\n    margin: 5px 0;\\n    color: #666;\\n}';\n  var headEl = document.head || document.getElementsByTagName('head')[0];\n  var styleEl = document.createElement('style');\n  styleEl.type = 'text/css';\n  styleEl.textContent = styleText;\n  headEl.appendChild(styleEl);\n}\n\nvar Component = _react2.default.Component;\n\nvar SCALE = 0.8;\nvar SIZE_WIDTH = 32 * SCALE;\nvar SIZE_HEIGHT = 46 * SCALE - 2;\nvar SIZE_HOVER_WIDTH = 46 * SCALE;\nvar SIZE_HOVER_HEIGHT = 66 * SCALE - 2;\nvar MAX_INFO_MARKERS = 42;\n\nvar defaultOpts = {\n  useCluster: false,\n  markersCache: [],\n  markerIDCache: []\n};\n\nvar ClusterProps = ['gridSize', 'minClusterSize', 'maxZoom', 'averageCenter', 'styles', 'zoomOnClick', 'renderCluserMarker'];\n\nvar IdKey = '__react_amap__';\n\n/*\n * props\n * {\n *  useCluster(boolean)是否使用聚合点\n *  markers(array<>)坐标列表\n *  __map__ 父级组件传过来的地图实例\n *  __ele__ 父级组件传过来的地图容器\n * }\n */\n\nvar Markers = function (_Component) {\n  _inherits(Markers, _Component);\n\n  function Markers(props) {\n    _classCallCheck(this, Markers);\n\n    var _this = _possibleConstructorReturn(this, (Markers.__proto__ || Object.getPrototypeOf(Markers)).call(this, props));\n\n    if (typeof window !== 'undefined') {\n      if (!props.__map__) {\n        _log2.default.warning('MAP_INSTANCE_REQUIRED');\n      } else {\n        _this.map = props.__map__;\n        _this.element = _this.map.getContainer();\n        _this.markersCache = defaultOpts.markersCache;\n        _this.useCluster = null;\n        _this.markerIDCache = defaultOpts.markerIDCache;\n        _this.resetOffset = new window.AMap.Pixel(-SIZE_WIDTH / 2, -SIZE_HEIGHT);\n        _this.hoverOffset = new window.AMap.Pixel(-SIZE_HOVER_WIDTH / 2, -SIZE_HOVER_HEIGHT);\n        _this.createMarkers(props);\n      }\n    }\n    return _this;\n  }\n\n  _createClass(Markers, [{\n    key: 'shouldComponentUpdate',\n    value: function shouldComponentUpdate() {\n      return false;\n    }\n  }, {\n    key: 'createMarkers',\n    value: function createMarkers(props) {\n      var _this2 = this;\n\n      var markers = props.markers || [];\n\n      var mapMarkers = [];\n      var markerReactChildDOM = {};\n      markers.length && markers.forEach(function (raw, idx) {\n        var options = _this2.buildCreateOptions(props, raw, idx);\n        options.map = _this2.map;\n\n        var markerContent = null;\n        if ((0, _isFun2.default)(props.render)) {\n          // $FlowFixMe\n          var markerChild = props.render(raw);\n          if (markerChild !== false) {\n            var div = document.createElement('div');\n            div.setAttribute(IdKey, '1');\n            markerContent = div;\n            markerReactChildDOM[idx] = markerChild;\n          }\n        }\n\n        if (!markerContent) {\n          markerContent = document.createElement('div');\n          var img = document.createElement('img');\n          img.src = '//webapi.amap.com/theme/v1.3/markers/n/mark_bs.png';\n          markerContent.appendChild(img);\n        }\n        options.content = markerContent;\n\n        var marker = new window.AMap.Marker(options);\n        marker.on('click', function (e) {\n          _this2.onMarkerClick(e);\n        });\n        marker.on('mouseover', function (e) {\n          _this2.onMarkerHover(e);\n        });\n        marker.on('mouseout', function (e) {\n          _this2.onMarkerHoverOut(e);\n        });\n\n        marker.render = function (marker) {\n          return function (component) {\n            return (0, _markerUtils.renderMarkerComponent)(component, marker);\n          };\n        }(marker);\n\n        _this2.bindMarkerEvents(marker);\n        mapMarkers.push(marker);\n      });\n      this.markersCache = mapMarkers;\n      this.markerReactChildDOM = markerReactChildDOM;\n      this.exposeMarkerInstance();\n\n      this.checkClusterSettings(props);\n    }\n  }, {\n    key: 'checkClusterSettings',\n    value: function checkClusterSettings(props) {\n      var _this3 = this;\n\n      if (props.useCluster) {\n        this.loadClusterPlugin(props.useCluster).then(function (cluster) {\n          cluster.setMarkers(_this3.markersCache);\n        });\n      } else {\n        if (this.mapCluster) {\n          var markers = this.mapCluster.getMarkers();\n          this.mapCluster.clearMarkers();\n          markers.forEach(function (marker) {\n            marker.setMap(_this3.map);\n          });\n        }\n      }\n    }\n  }, {\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      if (this.map) {\n        this.setMarkerChild();\n      }\n    }\n  }, {\n    key: 'setMarkerChild',\n    value: function setMarkerChild() {\n      var _this4 = this;\n\n      Object.keys(this.markerReactChildDOM).forEach(function (idx) {\n        var dom = _this4.markersCache[idx].getContent();\n        var child = _this4.markerReactChildDOM[idx];\n        _this4.renderMarkerChild(dom, child);\n      });\n    }\n  }, {\n    key: 'renderMarkerChild',\n    value: function renderMarkerChild(dom, child) {\n      (0, _reactDom.render)(_react2.default.createElement(\n        'div',\n        null,\n        child\n      ), dom);\n    }\n  }, {\n    key: 'buildCreateOptions',\n    value: function buildCreateOptions(props, raw, idx) {\n      var result = {};\n      // 强制用户通过 render 函数来定义外观\n      // const disabledKeys = ['label', 'icon', 'content'];\n      // 还是不强制好，通过覆盖的方式来(如果有 render，覆盖 content/icon);\n      var disabledKeys = ['extData'];\n      _markerUtils.MarkerAllProps.forEach(function (key) {\n        if (key in raw && disabledKeys.indexOf(key) === -1) {\n          result[key] = (0, _markerUtils.getPropValue)(key, raw[key]);\n        } else if (key in props) {\n          if ((0, _isFun2.default)(props[key])) {\n            var tmpValue = props[key].call(null, raw, idx);\n            result[key] = (0, _markerUtils.getPropValue)(key, tmpValue);\n          } else {\n            result[key] = (0, _markerUtils.getPropValue)(key, props[key]);\n          }\n        }\n      });\n      result.extData = raw;\n      return result;\n    }\n  }, {\n    key: 'componentWillReceiveProps',\n    value: function componentWillReceiveProps(nextProps) {\n      if (this.map) {\n        this.refreshMarkersLayout(nextProps);\n      }\n    }\n  }, {\n    key: 'refreshMarkersLayout',\n    value: function refreshMarkersLayout(nextProps) {\n      var markerChanged = nextProps.markers !== this.props.markers;\n      var clusterChanged = !!this.props.useCluster !== !!nextProps.useCluster;\n      if (markerChanged) {\n        this.markersCache.length && this.markersCache.forEach(function (marker) {\n          if (marker) {\n            marker.setMap(null);\n            marker = null;\n          }\n        });\n        this.markersCache = defaultOpts.markersCache;\n        this.createMarkers(nextProps);\n        this.setMarkerChild();\n      }\n      if (markerChanged || clusterChanged) {\n        if (this.markersWindow) {\n          this.markersWindow.close();\n        }\n      }\n      if (clusterChanged) {\n        this.checkClusterSettings(nextProps);\n      }\n    }\n  }, {\n    key: 'loadClusterPlugin',\n    value: function loadClusterPlugin(clusterConfig) {\n      var _this5 = this;\n\n      if (this.mapCluster) {\n        return Promise.resolve(this.mapCluster);\n      }\n      var config = typeof clusterConfig === 'boolean' ? {} : clusterConfig;\n      return new Promise(function (resolve) {\n        _this5.map.plugin(['AMap.MarkerClusterer'], function () {\n          resolve(_this5.createClusterPlugin(config));\n        });\n      });\n    }\n  }, {\n    key: 'createClusterPlugin',\n    value: function createClusterPlugin(config) {\n      var options = {};\n      // const style = {\n      //   url: clusterIcon,\n      //   size: new window.AMap.Size(56, 56),\n      //   offset: new window.AMap.Pixel(-28, -28)\n      // };\n      var defalutOptions = {\n        minClusterSize: 2,\n        zoomOnClick: false,\n        maxZoom: 18,\n        gridSize: 60,\n        // styles: [style, style, style],\n        averageCenter: true\n      };\n\n      ClusterProps.forEach(function (key) {\n        if (key in config) {\n          options[key] = config[key];\n        } else {\n          options[key] = defalutOptions[key];\n        }\n      });\n\n      this.mapCluster = new window.AMap.MarkerClusterer(this.map, [], options);\n      var events = {};\n      if ('events' in config) {\n        events = config.events;\n        if ('created' in events) {\n          events.created(this.mapCluster);\n        }\n      }\n      this.initClusterMarkerWindow();\n      this.bindClusterEvent(events);\n      return this.mapCluster;\n    }\n  }, {\n    key: 'onMarkerClick',\n    value: function onMarkerClick(e) {\n      var marker = e.target;\n      this.triggerMarkerClick(e, marker);\n    }\n  }, {\n    key: 'onMarkerHover',\n    value: function onMarkerHover(e) {\n      e.target.setTop(true);\n      this.setMarkerHovered(e, e.target);\n    }\n  }, {\n    key: 'onMarkerHoverOut',\n    value: function onMarkerHoverOut(e) {\n      e.target.setTop(false);\n      this.setMarkerHoverOut(e, e.target);\n    }\n  }, {\n    key: 'onWindowMarkerClick',\n    value: function onWindowMarkerClick(element) {\n      var marker = element.markerRef;\n      this.triggerMarkerClick(null, marker);\n    }\n  }, {\n    key: 'onWindowMarkerHover',\n    value: function onWindowMarkerHover(element) {\n      var marker = element.markerRef;\n      this.setMarkerHovered(null, marker);\n    }\n  }, {\n    key: 'onWindowMarkerHoverOut',\n    value: function onWindowMarkerHoverOut(element) {\n      var marker = element.markerRef;\n      this.setMarkerHoverOut(null, marker);\n    }\n  }, {\n    key: 'setMarkerHovered',\n    value: function setMarkerHovered(e, marker) {\n      this.triggerMarkerHover(e, marker);\n    }\n  }, {\n    key: 'setMarkerHoverOut',\n    value: function setMarkerHoverOut(e, marker) {\n      this.triggerMarkerHoverOut(e, marker);\n    }\n  }, {\n    key: 'triggerMarkerClick',\n    value: function triggerMarkerClick(e, marker) {\n      // const raw = marker.getExtData();\n      var events = this.props.events || {};\n      if ((0, _isFun2.default)(events.click)) {\n        events.click(e, marker);\n      }\n    }\n  }, {\n    key: 'triggerMarkerHover',\n    value: function triggerMarkerHover(e, marker) {\n      // const raw = marker.getExtData();\n      var events = this.props.events || {};\n      if ((0, _isFun2.default)(events.mouseover)) {\n        events.mouseover(e, marker);\n      }\n    }\n  }, {\n    key: 'triggerMarkerHoverOut',\n    value: function triggerMarkerHoverOut(e, marker) {\n      // const raw = marker.getExtData();\n      var events = this.props.events || {};\n      if ((0, _isFun2.default)(events.mouseout)) {\n        events.mouseout(e, marker);\n      }\n    }\n  }, {\n    key: 'initClusterMarkerWindow',\n    value: function initClusterMarkerWindow() {\n      this.markersWindow = new window.AMap.InfoWindow({\n        isCustom: true,\n        autoMove: true,\n        closeWhenClickMap: true,\n        content: '<span>loading...</span>',\n        showShadow: false,\n        offset: new window.AMap.Pixel(0, -20)\n      });\n      this.markersDOM = document.createElement('div');\n      this.markersDOM.className = 'amap_markers_pop_window';\n      this.markersWindow.setContent(this.markersDOM);\n    }\n  }, {\n    key: 'bindClusterEvent',\n    value: function bindClusterEvent(events) {\n      var _this6 = this;\n\n      this.mapCluster.on('click', function (e) {\n        if (_this6.props.useCluster && _this6.props.useCluster.zoomOnClick) {\n          //\n        } else {\n          var returnValue = true;\n          if ((0, _isFun2.default)(events.click)) {\n            returnValue = events.click(e);\n          }\n          if (returnValue !== false) {\n            _this6.showMarkersInfoWindow(e);\n          }\n        }\n      });\n    }\n  }, {\n    key: 'showMarkersInfoWindow',\n    value: function showMarkersInfoWindow(e) {\n      var _this7 = this;\n\n      var pos = e.lnglat;\n      var markers = e.markers;\n      this.markersDOM.innerHTML = '';\n      if (markers && markers.length) {\n        var length = markers.length;\n        if (length > MAX_INFO_MARKERS) {\n          markers = markers.slice(0, MAX_INFO_MARKERS);\n        }\n        markers.forEach(function (m) {\n          var contentDOM = m.getContent();\n          var itemDOM = document.createElement('div');\n          itemDOM.className = 'window_marker_item';\n          itemDOM.appendChild(contentDOM);\n          itemDOM.markerRef = m;\n          itemDOM.addEventListener('click', _this7.onWindowMarkerClick.bind(_this7, itemDOM), true);\n          itemDOM.addEventListener('mouseover', _this7.onWindowMarkerHover.bind(_this7, itemDOM), true);\n          itemDOM.addEventListener('mouseout', _this7.onWindowMarkerHoverOut.bind(_this7, itemDOM), true);\n\n          _this7.markersDOM.appendChild(itemDOM);\n        });\n        if (length > MAX_INFO_MARKERS) {\n          var warning = document.createElement('div');\n          warning.className = 'amap_markers_window_overflow_warning';\n          warning.innerText = '更多坐标请放大地图查看';\n          this.markersDOM.appendChild(warning);\n        }\n      }\n      this.markersWindow.open(this.map, pos);\n    }\n  }, {\n    key: 'exposeMarkerInstance',\n    value: function exposeMarkerInstance() {\n      if ('events' in this.props) {\n        var events = this.props.events || {};\n        if ((0, _isFun2.default)(events.created)) {\n          events.created(this.markersCache);\n        }\n      }\n    }\n  }, {\n    key: 'bindMarkerEvents',\n    value: function bindMarkerEvents(marker) {\n      var events = this.props.events || {};\n      var list = Object.keys(events);\n      var preserveEv = ['click', 'mouseover', 'mouseout', 'created'];\n      list.length && list.forEach(function (evName) {\n        if (preserveEv.indexOf(evName) === -1) {\n          marker.on(evName, events[evName]);\n        }\n      });\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      return null;\n    }\n  }]);\n\n  return Markers;\n}(Component);\n\nexports.default = Markers;"]},"metadata":{},"sourceType":"script"}