{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _withPropsReactive = require('../utils/withPropsReactive');\n\nvar _withPropsReactive2 = _interopRequireDefault(_withPropsReactive);\n\nvar _log = require('../utils/log');\n\nvar _log2 = _interopRequireDefault(_log);\n\nvar _polyeditor = require('../polyeditor');\n\nvar _polyeditor2 = _interopRequireDefault(_polyeditor);\n\nvar _common = require('../utils/common');\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n}\n\nvar Component = _react2.default.Component;\nvar configurableProps = ['path', 'extData', 'draggable',\n/* 扩展属性*/\n'visible', 'style'];\nvar allProps = configurableProps.concat(['zIndex', 'bubble', 'showDir']);\n\nvar Polyline = function (_Component) {\n  _inherits(Polyline, _Component);\n\n  function Polyline(props) {\n    _classCallCheck(this, Polyline);\n\n    var _this = _possibleConstructorReturn(this, (Polyline.__proto__ || Object.getPrototypeOf(Polyline)).call(this, props));\n\n    if (typeof window !== 'undefined') {\n      if (!props.__map__) {\n        _log2.default.warning('MAP_INSTANCE_REQUIRED');\n      } else {\n        var self = _this;\n        _this.setterMap = {\n          visible: function visible(val) {\n            if (val) {\n              self.polyline && self.polyline.show();\n            } else {\n              self.polyline && self.polyline.hide();\n            }\n          },\n          style: function style(val) {\n            self.polyline.setOptions(val);\n          }\n        };\n        _this.converterMap = {\n          path: function path(val) {\n            return self.buildPathValue(val);\n          }\n        };\n        _this.state = {\n          loaded: false\n        };\n        _this.map = props.__map__;\n        _this.element = _this.map.getContainer();\n        setTimeout(function () {\n          _this.createMapPolyline(props);\n        }, 13);\n      }\n    }\n\n    return _this;\n  }\n\n  _createClass(Polyline, [{\n    key: 'createMapPolyline',\n    value: function createMapPolyline(props) {\n      var options = this.buildCreateOptions(props);\n      options.map = this.map;\n      this.polyline = new window.AMap.Polyline(options);\n      this.setState({\n        loaded: true\n      });\n      this.props.onInstanceCreated && this.props.onInstanceCreated();\n    }\n  }, {\n    key: 'buildCreateOptions',\n    value: function buildCreateOptions(props) {\n      var _this2 = this;\n\n      var options = {};\n      allProps.forEach(function (key) {\n        if (key in props) {\n          if (key === 'style' && props.style) {\n            var styleItem = Object.keys(props.style);\n            styleItem.forEach(function (item) {\n              // $FlowFixMe\n              options[item] = props.style[item];\n            }); // visible 做特殊处理\n          } else if (key !== 'visible') {\n            options[key] = _this2.getSetterValue(key, props[key]);\n          }\n        }\n      });\n      return options;\n    }\n  }, {\n    key: 'detectPropChanged',\n    value: function detectPropChanged(key, nextProps) {\n      return this.props[key] !== nextProps[key];\n    }\n  }, {\n    key: 'getSetterValue',\n    value: function getSetterValue(key, value) {\n      if (key in this.converterMap) {\n        return this.converterMap[key](value);\n      }\n\n      return value;\n    }\n  }, {\n    key: 'buildPathValue',\n    value: function buildPathValue(path) {\n      if (path.length) {\n        if ('getLng' in path[0]) {\n          return path;\n        }\n\n        return path.map(function (p) {\n          return (0, _common.toLnglat)(p);\n        });\n      }\n\n      return path;\n    }\n  }, {\n    key: 'renderEditor',\n    value: function renderEditor(children) {\n      if (!children) {\n        return null;\n      }\n\n      if (_react2.default.Children.count(children) !== 1) {\n        return null;\n      }\n\n      var child = _react2.default.Children.only(children);\n\n      if (child.type === _polyeditor2.default) {\n        return _react2.default.cloneElement(child, {\n          __poly__: this.polyline,\n          __map__: this.map\n        });\n      }\n\n      return null;\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      return this.state.loaded ? this.renderEditor(this.props.children) : null;\n    }\n  }, {\n    key: 'instance',\n    get: function get() {\n      return this.polyline;\n    }\n  }]);\n\n  return Polyline;\n}(Component);\n\nexports.default = (0, _withPropsReactive2.default)(Polyline);","map":{"version":3,"sources":["/home/kzj/project/finalize/final/code/react_code/node_modules/react-amap/lib/polyline/index.js"],"names":["Object","defineProperty","exports","value","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","key","Constructor","protoProps","staticProps","prototype","_react","require","_react2","_interopRequireDefault","_withPropsReactive","_withPropsReactive2","_log","_log2","_polyeditor","_polyeditor2","_common","obj","__esModule","default","_classCallCheck","instance","TypeError","_possibleConstructorReturn","self","call","ReferenceError","_inherits","subClass","superClass","create","constructor","setPrototypeOf","__proto__","Component","configurableProps","allProps","concat","Polyline","_Component","_this","getPrototypeOf","window","__map__","warning","setterMap","visible","val","polyline","show","hide","style","setOptions","converterMap","path","buildPathValue","state","loaded","map","element","getContainer","setTimeout","createMapPolyline","options","buildCreateOptions","AMap","setState","onInstanceCreated","_this2","forEach","styleItem","keys","item","getSetterValue","detectPropChanged","nextProps","p","toLnglat","renderEditor","children","Children","count","child","only","type","cloneElement","__poly__","render","get"],"mappings":"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","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _withPropsReactive = require('../utils/withPropsReactive');\n\nvar _withPropsReactive2 = _interopRequireDefault(_withPropsReactive);\n\nvar _log = require('../utils/log');\n\nvar _log2 = _interopRequireDefault(_log);\n\nvar _polyeditor = require('../polyeditor');\n\nvar _polyeditor2 = _interopRequireDefault(_polyeditor);\n\nvar _common = require('../utils/common');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar Component = _react2.default.Component;\n\nvar configurableProps = ['path', 'extData', 'draggable',\n\n/* 扩展属性*/\n'visible', 'style'];\n\nvar allProps = configurableProps.concat(['zIndex', 'bubble', 'showDir']);\n\nvar Polyline = function (_Component) {\n  _inherits(Polyline, _Component);\n\n  function Polyline(props) {\n    _classCallCheck(this, Polyline);\n\n    var _this = _possibleConstructorReturn(this, (Polyline.__proto__ || Object.getPrototypeOf(Polyline)).call(this, props));\n\n    if (typeof window !== 'undefined') {\n      if (!props.__map__) {\n        _log2.default.warning('MAP_INSTANCE_REQUIRED');\n      } else {\n        var self = _this;\n        _this.setterMap = {\n          visible: function visible(val) {\n            if (val) {\n              self.polyline && self.polyline.show();\n            } else {\n              self.polyline && self.polyline.hide();\n            }\n          },\n          style: function style(val) {\n            self.polyline.setOptions(val);\n          }\n        };\n        _this.converterMap = {\n          path: function path(val) {\n            return self.buildPathValue(val);\n          }\n        };\n        _this.state = {\n          loaded: false\n        };\n        _this.map = props.__map__;\n        _this.element = _this.map.getContainer();\n        setTimeout(function () {\n          _this.createMapPolyline(props);\n        }, 13);\n      }\n    }\n    return _this;\n  }\n\n  _createClass(Polyline, [{\n    key: 'createMapPolyline',\n    value: function createMapPolyline(props) {\n      var options = this.buildCreateOptions(props);\n      options.map = this.map;\n      this.polyline = new window.AMap.Polyline(options);\n      this.setState({\n        loaded: true\n      });\n      this.props.onInstanceCreated && this.props.onInstanceCreated();\n    }\n  }, {\n    key: 'buildCreateOptions',\n    value: function buildCreateOptions(props) {\n      var _this2 = this;\n\n      var options = {};\n      allProps.forEach(function (key) {\n        if (key in props) {\n          if (key === 'style' && props.style) {\n            var styleItem = Object.keys(props.style);\n            styleItem.forEach(function (item) {\n              // $FlowFixMe\n              options[item] = props.style[item];\n            });\n            // visible 做特殊处理\n          } else if (key !== 'visible') {\n            options[key] = _this2.getSetterValue(key, props[key]);\n          }\n        }\n      });\n      return options;\n    }\n  }, {\n    key: 'detectPropChanged',\n    value: function detectPropChanged(key, nextProps) {\n      return this.props[key] !== nextProps[key];\n    }\n  }, {\n    key: 'getSetterValue',\n    value: function getSetterValue(key, value) {\n      if (key in this.converterMap) {\n        return this.converterMap[key](value);\n      }\n      return value;\n    }\n  }, {\n    key: 'buildPathValue',\n    value: function buildPathValue(path) {\n      if (path.length) {\n        if ('getLng' in path[0]) {\n          return path;\n        }\n        return path.map(function (p) {\n          return (0, _common.toLnglat)(p);\n        });\n      }\n      return path;\n    }\n  }, {\n    key: 'renderEditor',\n    value: function renderEditor(children) {\n      if (!children) {\n        return null;\n      }\n      if (_react2.default.Children.count(children) !== 1) {\n        return null;\n      }\n      var child = _react2.default.Children.only(children);\n      if (child.type === _polyeditor2.default) {\n        return _react2.default.cloneElement(child, {\n          __poly__: this.polyline,\n          __map__: this.map\n        });\n      }\n      return null;\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      return this.state.loaded ? this.renderEditor(this.props.children) : null;\n    }\n  }, {\n    key: 'instance',\n    get: function get() {\n      return this.polyline;\n    }\n  }]);\n\n  return Polyline;\n}(Component);\n\nexports.default = (0, _withPropsReactive2.default)(Polyline);"]},"metadata":{},"sourceType":"script"}