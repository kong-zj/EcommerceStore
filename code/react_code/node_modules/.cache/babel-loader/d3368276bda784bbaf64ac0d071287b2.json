{"ast":null,"code":"import \"antd/es/drawer/style\";\nimport _Drawer from \"antd/es/drawer\";\nimport \"antd/es/skeleton/style\";\nimport _Skeleton from \"antd/es/skeleton\";\nimport \"antd/es/list/style\";\nimport _List from \"antd/es/list\";\nimport \"antd/es/divider/style\";\nimport _Divider from \"antd/es/divider\";\nimport \"antd/es/space/style\";\nimport _Space from \"antd/es/space\";\nimport \"antd/es/button/style\";\nimport _Button from \"antd/es/button\";\nimport \"antd/es/message/style\";\nimport _message from \"antd/es/message\";\nimport \"antd/es/select/style\";\nimport _Select from \"antd/es/select\";\nvar _jsxFileName = \"/home/kzj/project/finalize/final/code/react_code/src/components/Auction/Sell/index.jsx\";\nimport React, { Component } from \"react\";\nimport { UserOutlined, LaptopOutlined, FileSearchOutlined, HomeOutlined, EyeTwoTone, EyeInvisibleOutlined, RocketOutlined } from '@ant-design/icons';\nimport cookie from \"react-cookies\"; //接入web3\n\nimport getWeb3 from \"../../../utils/getWeb3\";\nimport getEcommerceStore from \"../../../utils/getEcommerceStore\";\nimport openNotification from \"../../Notification\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst {\n  Option\n} = _Select;\nconst count = 6;\n\nclass Sell extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      visible: false,\n      //list\n      loading: false,\n      list: []\n    };\n\n    this.formatOrderInfo = async originInfo => {\n      let afterInfo = originInfo[0].map((item, index) => {\n        if (false == originInfo[2][index]) {\n          return {\n            //key从1开始\n            key: index + 1,\n            buyer: item,\n            sum: parseInt(originInfo[1][index])\n          };\n        }\n      });\n      return afterInfo;\n    };\n\n    this.showDrawer = () => {\n      this.setState({\n        visible: true\n      });\n    };\n\n    this.onClose = () => {\n      this.setState({\n        visible: false\n      });\n    };\n  } //格式化商品信息，为渲染界面做准备\n\n\n  async componentDidMount() {\n    console.log(\"生成Sell模块\"); //注意回调函数中的this，和外界的this不同，如果向使用外界的this，要赋值成that传过去\n    //注意要使用async，确保先拿到地址，用await关键字确保运行的先后顺序，再用这个地址调用合约方法\n\n    let that = this;\n    this.props.truffleContract.deployed().then(async i => {\n      console.log(\"发货模块中 调用合约的函数\");\n\n      try {\n        //即时获取当前地址，用该地址发交易\n        let currentAccount = await that.props.web3.eth.getAccounts(); //ID\n\n        let blockChainID = this.props.dataArray[0].ID;\n        i.orderInfo(blockChainID, {\n          from: currentAccount.toString()\n        }).then(async res => {\n          //可能返回为空，要判断是否真的取到了数据，如果不判断，直接调用 formatProductInfo(res)，里面的 ipfs 会报错\n          console.log(\"orderInfo 取到的原始数据为 : \");\n          console.dir(res); // 0: (3) ['0xaB16f539d0935C81bfd3fe6c2354D111e859cA53',...]\n          // 1: (3) [BN, BN, BN]\n          // 2: (3) [false, false, false]\n          //格式化数据，便于显示\n\n          let OrderArrayInfo = await this.formatOrderInfo(res);\n          console.log(\"格式化之后的数据 OrderArrayInfo 为 \");\n          console.dir(OrderArrayInfo);\n          this.setState({\n            list: OrderArrayInfo\n          });\n        });\n      } catch (err) {\n        _message.error(\"商品订单查询失败\", 2);\n\n        console.log(\"调用合约的orderInfo方法失败 \" + err);\n      }\n    });\n  }\n\n  render() {\n    const {\n      loading,\n      list\n    } = this.state;\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(_Button, {\n        type: \"primary\",\n        icon: /*#__PURE__*/_jsxDEV(RocketOutlined, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 42\n        }, this),\n        size: \"large\",\n        onClick: this.showDrawer,\n        children: \"\\u53D1\\u8D27\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(_Drawer, {\n        title: \"\\u53D1\\u8D27\",\n        width: 600,\n        onClose: this.onClose,\n        visible: this.state.visible,\n        bodyStyle: {\n          paddingBottom: 80\n        },\n        extra: /*#__PURE__*/_jsxDEV(_Space, {\n          children: /*#__PURE__*/_jsxDEV(_Button, {\n            onClick: this.onClose,\n            children: \"\\u53D6\\u6D88\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 129,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 13\n        }, this),\n        children: [/*#__PURE__*/_jsxDEV(_Divider, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 133,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(_List, {\n          className: \"demo-loadmore-list\",\n          itemLayout: \"horizontal\",\n          dataSource: list,\n          renderItem: item => /*#__PURE__*/_jsxDEV(_List.Item, {\n            actions: [/*#__PURE__*/_jsxDEV(\"a\", {\n              children: \"\\u786E\\u8BA4\"\n            }, \"list-loadmore-more\", false, {\n              fileName: _jsxFileName,\n              lineNumber: 141,\n              columnNumber: 23\n            }, this)],\n            children: /*#__PURE__*/_jsxDEV(_Skeleton, {\n              avatar: true,\n              title: false,\n              loading: item.loading,\n              active: true,\n              children: [/*#__PURE__*/_jsxDEV(_List.Item.Meta, {\n                title: /*#__PURE__*/_jsxDEV(\"p\", {\n                  children: [\"\\u4E70\\u5BB6: \", item.buyer]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 145,\n                  columnNumber: 24\n                }, this),\n                description: /*#__PURE__*/_jsxDEV(\"p\", {\n                  children: [item.sum, \" \\u4EF6\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 146,\n                  columnNumber: 30\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 144,\n                columnNumber: 15\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: \"\\u5185\\u5BB9\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 148,\n                columnNumber: 15\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 143,\n              columnNumber: 13\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 140,\n            columnNumber: 11\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 135,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 11\n    }, this);\n  }\n\n}\n\nexport default Sell;","map":{"version":3,"sources":["/home/kzj/project/finalize/final/code/react_code/src/components/Auction/Sell/index.jsx"],"names":["React","Component","UserOutlined","LaptopOutlined","FileSearchOutlined","HomeOutlined","EyeTwoTone","EyeInvisibleOutlined","RocketOutlined","cookie","getWeb3","getEcommerceStore","openNotification","Option","count","Sell","constructor","props","state","visible","loading","list","formatOrderInfo","originInfo","afterInfo","map","item","index","key","buyer","sum","parseInt","showDrawer","setState","onClose","componentDidMount","console","log","that","truffleContract","deployed","then","i","currentAccount","web3","eth","getAccounts","blockChainID","dataArray","ID","orderInfo","from","toString","res","dir","OrderArrayInfo","err","error","render","paddingBottom"],"mappings":"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","sourcesContent":["import React, {Component} from \"react\";\nimport { Menu, Layout, message, Drawer, Space, Button, Divider, Form, InputNumber, Input, Select, List, Avatar, Skeleton } from 'antd';\nimport { UserOutlined, LaptopOutlined, FileSearchOutlined, HomeOutlined, EyeTwoTone, EyeInvisibleOutlined, RocketOutlined } from '@ant-design/icons';\nimport cookie from \"react-cookies\";\n//接入web3\nimport getWeb3 from \"../../../utils/getWeb3\";\nimport getEcommerceStore from \"../../../utils/getEcommerceStore\";\nimport openNotification from \"../../Notification\";\n\nconst { Option } = Select;\n\nconst count = 6;\n\n\nclass Sell extends Component {\n\n    state = {\n        visible: false,\n        //list\n        loading: false,\n        list: [],\n    }\n\n    constructor (props) {\n        super (props);\n    }\n\n        //格式化商品信息，为渲染界面做准备\n      formatOrderInfo = async(originInfo) => {\n\n\n\n          let afterInfo = originInfo[0].map((item, index) => {\n            if(false == originInfo[2][index]){\n              return {\n                //key从1开始\n                key: index + 1,\n                buyer: item,\n                sum: parseInt(originInfo[1][index]),\n              }\n            }\n            \n          });\n     \n          return afterInfo;\n      }\n\n\n    async componentDidMount () {\n        console.log(\"生成Sell模块\");\n\n        //注意回调函数中的this，和外界的this不同，如果向使用外界的this，要赋值成that传过去\n        //注意要使用async，确保先拿到地址，用await关键字确保运行的先后顺序，再用这个地址调用合约方法\n        let that = this;\n        this.props.truffleContract.deployed().then( async (i) => {\n            console.log(\"发货模块中 调用合约的函数\");\n            try{\n                //即时获取当前地址，用该地址发交易\n                let currentAccount = await that.props.web3.eth.getAccounts();\n\n                //ID\n                let blockChainID = this.props.dataArray[0].ID;\n\n                i.orderInfo(blockChainID, { from: currentAccount.toString()}).then(async res => {\n                    //可能返回为空，要判断是否真的取到了数据，如果不判断，直接调用 formatProductInfo(res)，里面的 ipfs 会报错\n                    console.log(\"orderInfo 取到的原始数据为 : \");\n                    console.dir(res);\n\n                    // 0: (3) ['0xaB16f539d0935C81bfd3fe6c2354D111e859cA53',...]\n                    // 1: (3) [BN, BN, BN]\n                    // 2: (3) [false, false, false]\n\n                    //格式化数据，便于显示\n                    let OrderArrayInfo = await this.formatOrderInfo(res);\n                    console.log(\"格式化之后的数据 OrderArrayInfo 为 \");\n                    console.dir(OrderArrayInfo);\n\n                    this.setState({\n                        list: OrderArrayInfo,\n                    });\n                    \n                });  \n            }catch(err) {\n                message.error(\"商品订单查询失败\",2);\n                console.log(\"调用合约的orderInfo方法失败 \" + err);\n            }\n\n            \n        });\n    }\n\n    showDrawer = () => {\n        this.setState({\n          visible: true,\n        });\n      };\n    \n    onClose = () => {\n        this.setState({\n          visible: false,\n        });\n      };\n\n\n   \n    render () {\n\n\n      const { loading, list } = this.state;\n\n\n        return (\n\n\n          <div>\n\n            <Button type=\"primary\" icon={<RocketOutlined />} size={\"large\"} onClick={this.showDrawer}>\n                发货\n            </Button>\n\n            <Drawer\n          title=\"发货\"\n          width={600}\n          onClose={this.onClose}\n          visible={this.state.visible}\n          bodyStyle={{ paddingBottom: 80 }}\n          extra={\n            <Space>\n              <Button onClick={this.onClose}>取消</Button>\n            </Space>\n          }\n        >\n            <Divider />\n\n          <List\n        className=\"demo-loadmore-list\"\n        itemLayout=\"horizontal\"\n        dataSource={list}\n        renderItem={item => (\n          <List.Item\n            actions={[<a key=\"list-loadmore-more\">确认</a>]}\n          >\n            <Skeleton avatar title={false} loading={item.loading} active>\n              <List.Item.Meta\n                title={<p>买家: {item.buyer}</p>}\n                description={<p>{item.sum} 件</p>}\n              />\n              <div>内容</div>\n            </Skeleton>\n          </List.Item>\n        )}\n      />\n\n\n        </Drawer>\n\n            </div>\n\n            \n        );\n    }\n}\n\nexport default Sell;\n"]},"metadata":{},"sourceType":"module"}